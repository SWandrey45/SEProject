<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset= "utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Dublin Bikes</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    </head>

    <body>
        <header></header>
        <ul>
  <li><a href="http://www.dublinbikes.ie/">Dublin Bikes</a></li>
  <li><a href="https://www.rsa.ie/en/RSA/Pedestrians-and-Cyclists/Cycling-safety/">Bike Safety Tips</a></li>
  <li><a href="https://www.visitdublin.com/cycle-dublin-in-a-day">Cycling Route in Dublin</a></li>
</ul>
        <h3>Dublin Bikes</h3>
        <div id="map"></div>
        <center>
    <select class="DDM" id="dropdown"></select>
        <button class="button button1" onclick="DisplayStationInfo()">Submit</button>
    <p id="info"></p>
            </center>

    </body>
        <script>


            var sel = document.getElementById('dropdown');
            var opt = null;
            var data = JSON.parse({{data | tojson}});
            console.log(data);
            for (var i = 0; i < data.length; i++) {
                var station_name = data[i].name;
                var station_address = data[i].address;
                var station_status = data[i].status;
                var station_number = data[i].number;
                var station_lat = data[i].position_lat;
                var station_lng = data[i].position_lng;
                console.log(station_name, station_number, station_address, station_status, station_lat, station_lng);
                    opt = document.createElement('option');
                    opt.value = data[i].number;
                    opt.innerHTML = data[i].name;
                    sel.appendChild(opt);
            }

            var button = document.getElementById('info');

            for (var i = 0; i < data.length; i++) {
                var station_number = data[i].number;
                var station_address = data[i].address;
                var station_status = data[i].status;
                console.log(station_number, station_address, station_status)
                }
             function DisplayStationInfo(){

                var stations = document.getElementById("dropdown");
                var value = stations.options[stations.selectedIndex].value;
                var text = stations.options[stations.selectedIndex].innerHTML;

                // alert("Station number is " + value + " and is called " + text);


                var result = stations.options[stations.selectedIndex].text;

                document.getElementById("info").innerHTML = "Station number: " + value;
                }
            // Initialize and add the map


            function initMap() {
            // The location of Dublin
            var dublin = {lat: 53.350140, lng: -6.266155};
            // The map, centered at Dublin
            var map = new google.maps.Map(
            document.getElementById('map'), {zoom: 14, center: dublin});
            // The marker, positioned at Dublin
            var marker = new google.maps.Marker({position: dublin, map: map});
            for (var i = 0; i < data.length; i++) {
                var markers = new google.maps.Marker({position: new google.maps.LatLng(data[i].position_lat, data[i].position_lng),  map:map, title: data[i].name});
                var content = "<b>Station Name</b>: " + data[i].name + " <b>Station Number</b>: " + data[i].number + " <b>Station Address</b>: " + data[i].address + " <b>Station Status</b>: "+ data[i].status;
                var infowindow = new google.maps.InfoWindow({ content: content });
                marker.addListener('click', function() {
                    infowindow.open(map, marker);
                    });

            }
            }


        </script>
        <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDoK5Gvdq9S9U2KtsWFbMEZRKzFwKSdhgc&callback=initMap">
        </script>

</html>
